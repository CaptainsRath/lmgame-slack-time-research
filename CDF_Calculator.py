import numpy as np
import matplotlib
matplotlib.use('Agg')  # Use a non-GUI backend
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

# =============================
# ðŸ”¢ INSERT YOUR DATA BELOW
# All arrays must be same length
# =============================

action_time_with_thinking = np.array([
3192.91,7347.99,4620.48,5340.86,5510.48,10421.39,4378.23,5303.88,6604.74,8514.71,4350.90,6369.38,3990.10,5966.23,4782.20,8744.62,7281.60,6648.23,5282.45,7861.41,5042.55,6020.91,6352.61,6072.13,5631.88,4773.18,8544.36,4744.37,4528.67,5550.32,4490.54,3676.74,4257.56,2859.83,3119.90,3511.12,3501.91,4722.32,4203.60,4661.26,6468.60,6091.37,5171.35,8618.42,5350.69,5617.26,4986.75,5122.75,5625.46,6126.56,5100.71,5157.45,5691.02,5106.08,4328.09,6532.47,4099.27,5728.18,4645.79,8032.54,5603.49,5444.13,4517.11,5096.07,4329.68,4679.58,5237.10,5907.47,5409.40,5050.83,5313.77,5979.61,4694.92,5696.89,3908.04,3682.03,3526.72,5571.84,4101.06,4471.22,5482.04,6004.44,4979.49,5149.21,4331.98,4769.79,3235.10,4789.42,6747.50,5920.85,5735.39,6714.15,4717.06,3888.36,4120.04,3561.02,3495.79,7150.52,3763.32,3055.29,7724.17,4339.21,5173.05,5911.93,5892.76])

action_time_with_thinking_simple = np.array([
6320, 6053, 7553, 5656, 6212, 6546, 8718, 6113, 5089, 6647, 5744, 5997, 11470, 6106, 9368, 7431, 7870, 6868, 8753, 7373, 4822, 6432, 7544, 7875, 5278, 4688, 3808, 6403, 6406, 9517, 8443, 7527, 9080, 7300, 5561, 5101, 0, 6941, 5339, 5214, 4209, 5643, 7654, 5609, 4879, 3329, 4992, 7213, 4244, 3659, 4883, 13556, 6836, 8568, 5874, 5769, 5001, 4216, 5545, 6882, 5240, 5203, 5324, 6216, 5878, 8402, 4695, 8642, 5808, 4857, 5990, 6079, 6573, 4651, 6249, 8839, 8399, 3616, 3883, 4561, 7056, 8210, 8967, 4979, 8136, 5435, 6656, 5996, 5810, 7101, 5666, 6383, 6103, 8248, 5862, 4741, 6677, 6100, 4768, 4768, 7717, 6691, 5776, 3893, 5676, 4976, 6418, 8319, 8432, 7734, 5932, 7550, 6404, 5129, 9471, 6103, 5466, 5324, 17126, 6896, 5546, 8429, 9494, 5010, 6769, 8321, 5671, 6832, 5996, 10980, 8959, 5908, 5989, 4959, 5340, 4658, 5438, 7035, 4918, 4263, 5080, 4988, 9206, 6673, 5322, 4438, 5126, 6345, 6398, 6666, 6995, 9232, 8691, 8630, 4251, 8145, 4355, 3970, 4972, 6432, 5337, 3873, 6465, 3604, 6291, 11224, 5543, 6822, 8046, 6535, 7100, 15638, 9171, 7088, 15528, 7989, 5544, 9655, 10425, 6884, 7489, 6883, 5815, 7595, 11742, 7157, 6765, 8542, 5772, 4661, 5705, 5656, 6246, 5102, 6599, 7208, 5857, 9651, 6102, 4699, 12539, 8295, 5993, 4109, 5613])
action_time_without_thinking = np.array([
6393, 5921, 8555, 7705, 8039, 7093, 10396, 5376, 14353, 30175, 10787, 27652, 10494, 13391, 20698, 9667, 22771, 17777, 18420, 13115, 11967, 13475, 9899, 16647, 5956, 13914, 12308, 19571, 9323, 21973, 12271, 7788, 19363, 10615, 20280, 22698, 17010, 18794, 13420, 6700, 14315, 14442, 33193, 20655, 13784, 24134, 22141, 19022, 20754, 13945, 9890, 8999, 12817, 9123, 33510, 8358, 6961, 5677, 5791, 4002, 4357, 31209, 8519, 11673, 18092, 8097, 8622, 4097, 3495, 4132, 11060, 8598, 4950, 8433, 15187, 7467, 6980, 1455, 10298, 12184, 5844, 3393, 4285, 3654, 4865, 5969, 7861, 7334, 9174, 14950, 23568, 15482, 17115, 15015, 22711, 31745, 21149, 14513, 14758, 9645, 15580, 18762, 34185, 6571, 7911, 17822, 12054, 12878, 22635, 15416, 26293, 26933, 10930, 10582, 6081, 20175, 16888, 7773, 13160, 3536, 6951, 13932, 15779, 3898, 4253, 7743, 19012, 6665, 9983, 14726, 25807, 32178, 16892, 11147, 21313, 18647, 11562, 18166])

runtime_slack_thinking = np.array([
10597, 10162, 9067, 12860, 18536, 28828, 15874, 30954, 15595, 16978, 15884, 13475, 15164, 16914, 13149, 17859, 14343, 12074, 28529, 14205, 19803, 20378, 21099, 24282, 29325, 18390, 21443, 11867, 12931, 8951, 10592, 10657, 12039, 23154, 9745, 9987, 9949, 12476, 12758, 13604, 32637, 16119, 17136, 16585, 25350, 14057, 21828, 22194, 11830, 15979, 25943, 19766, 17347, 17872, 17746, 19715, 16296, 20473, 15807, 14442, 13335, 15610, 23128, 10211, 15627, 25137, 13600, 22276, 11872, 24057, 15545, 13335, 23343, 26810, 25492, 17003, 15336, 19024, 8706, 14713, 20580, 19267, 22271, 41384, 13616, 16969, 19362, 14127, 11416, 7403, 7554, 9860, 13203, 14713, 9328, 12281, 11734, 14084, 9779, 12691, 17231, 23351, 36975, 24129])
runtime_slack_thinking_simple = np.array([
12705, 13991, 15384, 15868, 40068, 23541, 21541, 22015, 17118, 18274, 12743, 19267, 18090, 20063, 17494, 19462, 20268, 28317, 17180, 20102, 17589, 16707, 12437, 16089, 18973, 18483, 18194, 23945, 27394, 21227, 22227, 16736, 28142, 26385, 19898, 20037, 24842, 16534, 10710, 9669, 13778, 16022, 11925, 11941, 19641, 15495, 14242, 14455, 19453, 50107, 18919, 19658, 16310, 17232, 22502, 11003, 16382, 13550, 17641, 17606, 46029, 22012, 34029, 21113, 25922, 24911, 25697, 36225, 23812, 22435, 10690, 11320, 11070, 13456, 10500, 9381, 14272, 9017, 14611, 12701, 27094, 25041, 20384, 21532, 21665, 25232, 13012, 16377, 15051, 19603, 16766, 16337, 19421, 19788, 17356, 22494, 23264, 22257, 17590, 14677, 22146, 12704, 11157, 12085, 13296, 13702, 18902, 28289, 16036, 18639, 22069, 17480, 21476, 38681, 26759, 22393, 14676, 17323, 13841, 19369, 20342, 28868, 17302, 15276, 16008, 17174, 27777, 20084, 13684, 21281, 20031, 13099, 32677, 10031, 13038, 10378, 18649, 19013, 6822, 12671, 12018, 17877, 16267, 19943, 21719, 29260, 19519, 22768, 30117, 28828, 21890, 30036, 30303, 20662, 13453, 13442, 11052, 12916, 16163, 14237, 14493, 10717, 13330, 14330, 17105, 16713, 31591, 26340, 25030, 27870, 36975, 27849, 24722, 25443, 25334, 15319, 24544, 22861, 22156, 22943, 30965, 19172, 22120, 16839, 35048, 25800, 26773, 29408, 17554, 10413, 13628, 16289, 16652, 18997, 19085, 15829, 21721, 18894, 21009, 27177, 10539, 20015, 17043, 12393])
runtime_slack_no_thinking = np.array([
12010, 8610, 11720, 14258, 11416, 11021, 9922, 20580, 17211, 17967, 15654, 29466, 26227, 19822, 15640, 17106, 21187, 33615, 23012, 10865, 20435, 9465, 14666, 17903, 14911, 11395, 8617, 14358, 11173, 9595, 11855, 10531, 15075, 13240, 21952, 20142, 13357, 20406, 20480, 17778, 22231, 16701, 11974, 12183, 18646, 15756, 14761, 18346, 11648, 15537, 15098, 17452, 10128, 15755, 11006, 12650, 12599, 12467, 12112, 10960, 21905, 17979, 17856, 15717, 23035, 27886, 20511, 18683, 26169, 18680, 10767, 36443, 17270, 15532, 8968, 13036, 10421, 13284, 9979, 10376, 12507, 12000, 10143, 8984, 10413, 14154, 8577, 22162, 15429, 10887, 32602, 21988, 14042, 19046, 13364, 21498, 25876, 18366, 14874, 11129, 24774, 16402, 15842, 11272, 13714, 11737, 16589, 15603, 22629, 24611, 25688, 19979, 20939, 10642, 6666, 5051, 10084, 11571, 13207, 12777, 7640, 16166, 11499, 11223, 12548, 9175, 10734, 15361, 17282, 19251, 15921, 31073, 23461, 24022, 20466, 12822, 15622
])
# =============================
# ðŸ“ˆ CDF Function
# =============================

def compute_cdf(data):
    sorted_data = np.sort(data)
    cdf = np.arange(1, len(data) + 1) / len(data)

    # Start at (0, 0)
    sorted_data = np.insert(sorted_data, 0, 0)
    cdf = np.insert(cdf, 0, 0.0)

    return sorted_data, cdf

def smooth_cdf(x, y, points=200):
    f = interp1d(x, y, kind='linear')
    x_smooth = np.linspace(x.min(), x.max(), points)
    y_smooth = f(x_smooth)
    return x_smooth, y_smooth

# =============================
# ðŸ“Š Compute, smooth, and plot CDFs
# =============================

x1, y1 = compute_cdf(action_time_with_thinking)
x2, y2 = compute_cdf(action_time_with_thinking_simple)
x3, y3 = compute_cdf(action_time_without_thinking)
x4, y4 = compute_cdf(runtime_slack_thinking)
x5, y5 = compute_cdf(runtime_slack_thinking_simple)
x6, y6 = compute_cdf(runtime_slack_no_thinking)

x1_smooth, y1_smooth = smooth_cdf(x1, y1)
x2_smooth, y2_smooth = smooth_cdf(x2, y2)
x3_smooth, y3_smooth = smooth_cdf(x3, y3)
x4_smooth, y4_smooth = smooth_cdf(x4, y4)
x5_smooth, y5_smooth = smooth_cdf(x5, y5)
x6_smooth, y6_smooth = smooth_cdf(x6, y6)

plt.figure(figsize=(8, 6))
plt.plot(x1_smooth, y1_smooth, label='Action Time w/ Thinking', linewidth=2)
plt.plot(x2_smooth, y2_smooth, label='Action Time w/ Thinking Simple', linewidth=2)
plt.plot(x3_smooth, y3_smooth, label='Action Time w/o Thinking', linewidth=2)
plt.plot(x4_smooth, y4_smooth, label='Runtime Slack Thinking', linewidth=2)
plt.plot(x5_smooth, y5_smooth, label='Runtime Slack Thinking Simple', linewidth=2)
plt.plot(x6_smooth, y6_smooth, label='Runtime Slack No Thinking', linewidth=2)

plt.xlabel('Latency (ms)')
plt.ylabel('CDF ([0, 1])')
plt.title('CDF of Latency Metrics')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig('cdf_plot.png')
